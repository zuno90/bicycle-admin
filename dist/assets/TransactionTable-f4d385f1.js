import{o as v,g as C,u as w,a as S,b as B,c as L,j as e,m as D,L as E,p as f,a6 as b}from"./index-e9cea786.js";import{P}from"./Pagination-6d075f1d.js";import{M}from"./Modal-4a1ac01e.js";import{c as d}from"./config.util-005c10b6.js";import{c}from"./index-090a6308.js";import{q as T}from"./base-e8aaf39e.js";import{u as q}from"./useQuery-5cab7715.js";import"./utils-30ebd027.js";import"./suspense-3cc1710c.js";var j=(a=>(a.all="Tất cả",a.pending="Chờ xử lý",a.success="Đã xác nhận",a.canceled="Đã huỷ",a))(j||{});const A=async(a,m,r)=>{const l=T.stringify({page:a,limit:m,status:r},{skipNull:!0,skipEmptyString:!0}),i=await v(`${d.endpoint}/payments?${l}`,{Authorization:`Bearer ${C(d.cache.accessToken)}`});if(i.success)return i.data},Q=({title:a})=>{const{search:m}=w(),r=S(),l=B(t=>t.common),i=L(),s=new URLSearchParams(m),u=Number(s.get("page"))||d.pagination.PAGE,h=Number(s.get("limit"))||d.pagination.LIMIT,g=s.get("status"),{data:n,isLoading:y}=q({queryKey:["transactions",{page:u,limit:h,status:g}],queryFn:()=>A(u,h,g)});console.log(l);const o=t=>{s.delete("page"),s.delete("limit"),t==="all"?s.delete("status"):s.set("status",t),r({search:s.toString()})},p=n&&n.totalStatusPayment[s.get("status")??"all"],x=()=>i(b(!1)),N=()=>{var t;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{children:"Vui lòng xác nhận số tiền nhận được tại đây"}),e.jsxs("div",{className:"py-8 bg-gray text-2xl font-semibold rounded-lg",children:["đ"," ",f(n&&((t=n.payments)==null?void 0:t.filter(F=>F.id===l.modalId)[0].amount))]})]})},k=()=>e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-[#DDDDDD] text-black px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-[#B6B6B6] hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:x,children:"Huỷ"}),e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-[#FBE69E] text-black px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-[#FFC700] hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>{x(),r("/chat?uid=2")},children:"Nhắn tin"}),e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-primary text-white px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:x,children:"Xác nhận"})]});return y?e.jsx(D,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-10 mb-4",children:[e.jsx("div",{className:"w-full inline-flex items-center justify-between",children:e.jsx("h4",{className:"text-xl font-semibold text-black dark:text-white",children:a})}),e.jsxs("div",{className:"inline-flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o("all"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":!s.get("status")}),children:["Tất cả (",n.totalStatusPayment.all,")"]}),e.jsxs("button",{onClick:()=>o("pending"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="pending"}),children:["Chờ xử lý (",n.totalStatusPayment.pending,")"]}),e.jsxs("button",{onClick:()=>o("success"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="success"}),children:["Đã xác nhận (",n.totalStatusPayment.success,")"]}),e.jsxs("button",{onClick:()=>o("canceled"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="canceled"}),children:["Đã huỷ (",n.totalStatusPayment.canceled,")"]})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"grid grid-cols-8 border-stroke py-4 dark:border-strokedark sm:grid-cols-8",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm font-bold xsm:text-base",children:"ID"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Ngày"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Tên"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Số điện thoại"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Nội dung"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Số tiền"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Trạng thái"})}),e.jsx("div",{className:"col-span-1 text-center",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Hành động"})})]}),n.payments.length>0&&n.payments.map(t=>e.jsxs("div",{className:c("grid grid-cols-8 border-t border-stroke py-4 dark:border-strokedark sm:grid-cols-8",{"bg-[#FFF7D9] dark:bg-meta-3":t.status==="pending"}),children:[e.jsx(E,{to:`/transaction/${t.id}`,className:"col-span-1 flex items-center",children:e.jsx("p",{className:"text-xs text-black dark:text-white",children:t.id})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs font-semibold text-center text-black dark:text-white text-ellipsis overflow-hidden",children:new Date(t.createAt).toLocaleDateString("en-GB")})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.user.name})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.user.phoneNumber})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.content})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsxs("p",{className:"text-xs text-center text-black dark:text-white",children:["đ",f(t.amount)]})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:c("text-xs text-center text-black dark:text-white",{"text-meta-1":t.status==="pending"}),children:j[t.status]})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("button",{type:"button",onClick:()=>i(b({id:t.id,isOpen:!0})),children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"12",cy:"12",r:"11",stroke:"#7C7C7C",strokeWidth:"2"}),e.jsx("path",{d:"M8.41005 7.38995C7.86332 6.84321 7.86332 5.95679 8.41005 5.41005C8.95679 4.86332 9.84321 4.86332 10.3899 5.41005L15.99 11.0101C16.5367 11.5568 16.5367 12.4432 15.99 12.99L10.3899 18.5899C9.84321 19.1367 8.95679 19.1367 8.41005 18.5899C7.86332 18.0432 7.86332 17.1568 8.41005 16.6101L13.0201 12L8.41005 7.38995Z",fill:"#7C7C7C"})]})})})]},t.id)),p>0&&e.jsx("div",{className:"flex justify-center items-center my-4",children:e.jsx(P,{page:u,limit:h,total:p})}),l.isOpenModal&&e.jsx(M,{title:"Xác nhận giao dịch",body:e.jsx(N,{}),footer:e.jsx(k,{}),close:x})]})]})};export{Q as default};
