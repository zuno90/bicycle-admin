import{o as v,g as w,u as C,a as S,b as L,c as A,j as e,m as B,L as M,p as f,a5 as b}from"./index-263fac7a.js";import{P as D}from"./Pagination-9c5dc3b2.js";import{M as E}from"./Modal-c9626d66.js";import{c as d}from"./config.util-005c10b6.js";import{c}from"./index-6ae700ae.js";import{q as P}from"./base-e8aaf39e.js";import{u as T}from"./useQuery-d2af741a.js";import"./utils-8a810215.js";import"./suspense-75094ebc.js";var j=(a=>(a.all="Tất cả",a.pending="Chờ xử lý",a.success="Đã xác nhận",a.canceled="Đã huỷ",a))(j||{});const q=async(a,m,i)=>{const r=P.stringify({page:a,limit:m,status:i},{skipNull:!0,skipEmptyString:!0}),l=await v(`${d.endpoint}/payments?${r}`,{Authorization:`Bearer ${w(d.cache.accessToken)}`});if(l.success)return l.data},Q=({title:a})=>{const{search:m}=C(),i=S(),r=L(t=>t.common),l=A(),s=new URLSearchParams(m),u=Number(s.get("page"))||d.pagination.PAGE,h=Number(s.get("limit"))||d.pagination.LIMIT,g=s.get("status"),{data:n,isLoading:y}=T({queryKey:["transactions",{page:u,limit:h,status:g}],queryFn:()=>q(u,h,g)}),o=t=>{s.delete("page"),s.delete("limit"),t==="all"?s.delete("status"):s.set("status",t),i({search:s.toString()})},p=n&&n.totalStatusPayment[s.get("status")??"all"],x=()=>l(b(!1)),N=()=>{var t;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{children:"Vui lòng xác nhận số tiền nhận được tại đây"}),e.jsxs("div",{className:"py-8 bg-gray text-2xl font-semibold rounded-lg",children:["đ"," ",f(n&&((t=n.payments)==null?void 0:t.filter(F=>F.id===r.modalId)[0].amount))]})]})},k=()=>e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-[#DDDDDD] text-black px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-[#B6B6B6] hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:x,children:"Huỷ"}),e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-[#FBE69E] text-black px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-[#FFC700] hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>{x(),i("/chat?uid=2")},children:"Nhắn tin"}),e.jsx("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-primary text-white px-3 py-2 text-sm font-semibold shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:x,children:"Xác nhận"})]});return y?e.jsx(B,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-10 mb-4",children:[e.jsx("div",{className:"w-full inline-flex items-center justify-between",children:e.jsx("h4",{className:"text-xl font-semibold text-black dark:text-white",children:a})}),e.jsxs("div",{className:"inline-flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o("all"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":!s.get("status")}),children:["Tất cả (",n.totalStatusPayment.all,")"]}),e.jsxs("button",{onClick:()=>o("pending"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="pending"}),children:["Chờ xử lý (",n.totalStatusPayment.pending,")"]}),e.jsxs("button",{onClick:()=>o("success"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="success"}),children:["Đã xác nhận (",n.totalStatusPayment.success,")"]}),e.jsxs("button",{onClick:()=>o("canceled"),type:"button",className:c("text-black bg-[#F3F3F3] hover:bg-[#FFC700]/90 focus:ring-2 focus:outline-none focus:ring-[#FFC700]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55",{"bg-[#FBE69E]":s.get("status")==="canceled"}),children:["Đã huỷ (",n.totalStatusPayment.canceled,")"]})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"grid grid-cols-8 border-stroke py-4 dark:border-strokedark sm:grid-cols-8",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm font-bold xsm:text-base",children:"ID"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Ngày"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Tên"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Số điện thoại"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Nội dung"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Số tiền"})}),e.jsx("div",{className:"col-span-1",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Trạng thái"})}),e.jsx("div",{className:"col-span-1 text-center",children:e.jsx("h5",{className:"text-sm text-center font-bold xsm:text-base",children:"Hành động"})})]}),n.payments.length>0&&n.payments.map(t=>e.jsxs("div",{className:c("grid grid-cols-8 border-t border-stroke py-4 dark:border-strokedark sm:grid-cols-8"),children:[e.jsx(M,{to:`/transaction/${t.id}`,className:"col-span-1 flex items-center",children:e.jsx("p",{className:"text-xs text-black dark:text-white",children:t.id})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs font-semibold text-center text-black dark:text-white text-ellipsis overflow-hidden",children:new Date(t.createAt).toLocaleDateString("en-GB")})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.user.name})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.user.phoneNumber})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:"text-xs text-center text-black dark:text-white",children:t.content})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsxs("p",{className:"text-xs text-center text-black dark:text-white",children:["đ",f(t.amount)]})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("p",{className:c("text-xs text-center text-black dark:text-white",{"text-meta-1":t.status==="pending"}),children:j[t.status]})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:e.jsx("button",{type:"button",onClick:()=>l(b({id:t.id,isOpen:!0})),children:e.jsx("svg",{className:"fill-current",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M8.6,16.6L13.2,12L8.6,7.4L10,6L16,12L10,18L8.6,16.6Z"})})})})]},t.id)),p>0&&e.jsx("div",{className:"flex justify-center items-center my-4",children:e.jsx(D,{page:u,limit:h,total:p})}),r.isOpenModal&&e.jsx(E,{title:"Xác nhận giao dịch",body:e.jsx(N,{}),footer:e.jsx(k,{}),close:x})]})]})};export{Q as default};
